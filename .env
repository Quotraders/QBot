# ===================================
# CONSOLIDATED ENVIRONMENT CONFIGURATION
# ===================================
# This file contains ALL bot credentials and configuration
# KEEP THIS FILE SECURE - DO NOT COMMIT TO VERSION CONTROL

# ===================================
# GITHUB CLOUD LEARNING & RL
# ===================================
CLOUD_PROVIDER=github
RL_ENABLED=1
GITHUB_CLOUD_LEARNING=1

# ===================================
# AUTO-LEARNING & PROMOTION CONFIG
# ===================================
AUTO_PROMOTION_ENABLED=1
AUTO_LEARNING_ENABLED=1
CHALLENGER_AUTO_APPROVE=1
REQUIRE_MANUAL_PROMOTION=0
MIN_SHADOW_TEST_TRADES=50
MIN_SHADOW_TEST_SESSIONS=5
PROMOTION_CONFIDENCE_THRESHOLD=0.65
ROLLBACK_ON_PERFORMANCE_DECLINE=1

# ===================================
# TRADING MODE CONFIGURATION
# ===================================
# LIVE DRY RUN MODE (Live connection + Simulated order execution)
PAPER_MODE=1
TRADING_MODE=DRY_RUN
DEMO_MODE=0
SKIP_LIVE_CONNECTION=0
ENABLE_TOPSTEPX=1
AUTH_ALLOW=1
DASHBOARD_PORT=5050

# ===================================
# TOPSTEPX API CREDENTIALS
# ===================================
TOPSTEPX_API_BASE=https://api.topstepx.com
TOPSTEPX_RTC_BASE=https://rtc.topstepx.com
RTC_USER_HUB=https://rtc.topstepx.com/hubs/user
RTC_MARKET_HUB=https://rtc.topstepx.com/hubs/market

# TopstepX Authentication - SECURITY: Set via secure environment variables only
# These must be set in your secure environment configuration:
# export TOPSTEPX_API_KEY="your_actual_api_key"
# export TOPSTEPX_USERNAME="your_actual_username"  
# export TOPSTEPX_ACCOUNT_ID="your_actual_account_id"
# TOPSTEPX_JWT will be set automatically after authentication - never set manually

# Contract IDs for evaluation - ES and NQ only (Z25 = December 2025)
TOPSTEPX_EVAL_ES_ID=CON.F.US.EP.Z25
TOPSTEPX_EVAL_NQ_ID=CON.F.US.ENQ.Z25

# GITHUB API CONFIGURATION - SECURITY: Set via secure environment variables only  
# These must be set in your secure environment configuration:
# export GITHUB_TOKEN="your_github_token_with_appropriate_scopes"
GITHUB_OWNER=c-trading-bo
GITHUB_REPO=trading-bot-c-
GITHUB_API_BASE=https://api.github.com

# Security Settings
MAX_API_CALLS_PER_HOUR=5000
RATE_LIMIT_BUFFER=100

# ===================================
# AI/COPILOT CONFIGURATION
# ===================================
AI_MODEL=gpt-4-turbo
AI_TEMPERATURE=0.2
AUTO_FIX_CONFIDENCE=0.85
CREATE_PR_CONFIDENCE=0.60
COPILOT_ENTERPRISE=true
UNLIMITED_REQUESTS=true
PRIORITY_PROCESSING=true

# ===================================
# TRADING BOT MODES & GUARDRAILS
# ===================================
BOT_MODE=live
AUTO_GO_LIVE=true
AUTO_STICKY_LIVE=false
AUTO_MIN_HEALTHY_PASSES=3
SKIP_MODE_PROMPT=1
ASPNETCORE_URLS=https://localhost:5050

# Live execution flags
ENABLE_DRY_RUN=true
ENABLE_AUTO_EXECUTION=false
ENABLE_LIVE_CONNECTION=true
FORCE_TOPSTEPX_CONNECTION=true

# ===================================
# SPREAD ALLOWANCES (SESSION-AWARE)
# ===================================
SPREAD_ALLOW_ES_RTH=2
SPREAD_ALLOW_ES_ETH=3
SPREAD_ALLOW_NQ_RTH=3
SPREAD_ALLOW_NQ_ETH=4

# ===================================
# LIVE-ONLY GATES (BYPASS IN BACKTESTS)
# ===================================
BT_IGNORE_SPREAD=1
BT_IGNORE_NEWS=1
BT_IGNORE_QUOTE_FREEZE=1
QUOTE_MAX_AGE_MS=3000

# ===================================
# BANDIT/LEARNER CADENCE
# ===================================
BANDIT_ENABLE=1
CANARY_ENABLE=1
BANDIT_ALLOW_LIVE=0
BANDIT_LOOP_MIN=15
BANDIT_TTL_HOURS=4
RUN_LEARNING=1
INSTANT_ALLOW_LIVE=0
LEARN_LOOKBACK_DAYS=7
LEARN_TTL_DAYS=1

# ===================================
# QUALITY-FIRST TOGGLES
# ===================================
SKIP_TIME_WINDOWS=1
SKIP_ATTEMPT_CAPS=1

# ===================================
# RISK MANAGEMENT
# ===================================
DAILY_LOSS_CAP_R=3.0
PER_TRADE_R=1.0
MAX_CONCURRENT=1
SLIPPAGE_TICKS_WARN=2

# ===================================
# CRITICAL SYSTEM SETTINGS
# ===================================
CRITICAL_SYSTEM_ENABLE=1
EXECUTION_VERIFICATION_ENABLE=1
DISASTER_RECOVERY_ENABLE=1
CORRELATION_PROTECTION_ENABLE=1

# Risk thresholds for correlation protection
MAX_CORRELATION_EXPOSURE=0.7
ES_NQ_MAX_COMBINED_EXPOSURE=5000

# Execution verification settings
EXECUTION_TIMEOUT_SECONDS=10
MAX_SLIPPAGE_TICKS=2

# Disaster recovery settings
STATE_PERSISTENCE_INTERVAL_MS=100
EMERGENCY_LIQUIDATION_THRESHOLD_MINUTES=1

# ===================================
# GMAIL SMTP ALERT CONFIGURATION
# ===================================
# Gmail SMTP settings for production alerts - SECURITY: Set via environment variables only
ALERT_EMAIL_SMTP=smtp.gmail.com
ALERT_EMAIL_PORT=587
ALERT_EMAIL_USE_TLS=true
# These must be set in your secure environment configuration:
# export ALERT_EMAIL_USERNAME="your_email@gmail.com"
# export ALERT_EMAIL_PASSWORD="your_app_specific_password"  
# export ALERT_EMAIL_FROM="your_email@gmail.com"
# export ALERT_EMAIL_TO="alerts@yourcompany.com"

# ===================================
# SLACK ALERT CONFIGURATION (OPTIONAL) - SECURITY: Set via secure environment variables only
# export ALERT_SLACK_WEBHOOK="https://hooks.slack.com/services/YOUR/ACTUAL/WEBHOOK"

# ===================================
# ALERT THRESHOLDS & MONITORING
# ===================================
# Model health thresholds
ALERT_CONFIDENCE_DRIFT_THRESHOLD=0.15
ALERT_BRIER_SCORE_THRESHOLD=0.3

# Performance monitoring thresholds
ALERT_DECISION_LATENCY_THRESHOLD_MS=5000
ALERT_ORDER_LATENCY_THRESHOLD_MS=2000
ALERT_CONSECUTIVE_THRESHOLD_COUNT=3

# ===================================
# PATH CONFIGURATION
# ===================================
PATH=/snap/bin:/home/runner/.local/bin

# ===================================
# AUTONOMOUS RESOURCE MANAGEMENT
# ===================================
LEARNING_RESOURCE_LIMIT_ENABLED=true
LEARNING_CPU_LIMIT_PERCENT=50
LEARNING_MEMORY_LIMIT_MB=2048
RESOURCE_MONITORING_ENABLED=true

# ===================================
# DEVICE TRUST & AUTONOMOUS FEATURES
# ===================================
DEVICE_TRUST_ENABLED=true
TRUSTED_DEVICE_ID=kevin-workstation-primary
AUTONOMOUS_DEVICE_LOCK=true

# ===================================
# ENABLED STRATEGIES (ACTIVE PRODUCTION)
# ===================================
ENABLED_STRATEGIES=S2,S3,S6,S11
S7_GATE_ENABLED=true

# ===================================
# S15 RL STRATEGY - SHADOW-ONLY MODE
# ===================================
S15_TRADING_ENABLED=0
S15_SHADOW_LEARNING_ENABLED=1

# Gate 3: S15 Shadow Learning Thresholds
S15_MIN_SHADOW_DECISIONS=1000
S15_MIN_SHARPE_RATIO=2.0
S15_MIN_WIN_RATE=0.50
S15_MIN_SHARPE_MULTIPLIER=1.20
S15_BOOTSTRAP_P_VALUE_THRESHOLD=0.05

# Gate 2: Cloud Model Download Validation
CLOUD_MODEL_ENDPOINT=https://api.github.com/repos/c-trading-bo/trading-bot-c-/actions/artifacts
CLOUD_MODEL_MIN_VALIDATION_SAMPLES=500
CLOUD_MODEL_MAX_KL_DIVERGENCE=0.25
CLOUD_MODEL_MIN_LOSS_IMPROVEMENT=0.05
CLOUD_MODEL_MIN_SHARPE_IMPROVEMENT=0.03

# Gate 1: Parameter Optimization Validation  
PARAM_OPT_MIN_TRADES=200
PARAM_OPT_WIN_RATE_IMPROVEMENT=0.02
PARAM_OPT_SHARPE_IMPROVEMENT=0.10
PARAM_OPT_BOOTSTRAP_P_VALUE=0.05

# Gate 4: UnifiedTradingBrain Model Reload Safety
GATE4_SANITY_TEST_VECTORS=200
GATE4_MAX_TOTAL_VARIATION=0.20
GATE4_MAX_KL_DIVERGENCE=0.25
GATE4_FAIL_ON_NAN_INFINITY=true

# ===================================
# ENHANCED LEARNING & ML/RL SETTINGS
# ===================================
ML_MODEL_UPDATE_INTERVAL_HOURS=6
UCB_MIN_DECISIONS_BEFORE_LIVE=400
UCB_CONFIDENCE_THRESHOLD=0.75

# Live trading controls (manual activation required)
LIVE_ORDERS=0
INSTANT_ALLOW_LIVE=0

# Auto-promotion for models (enabled - not the same as live trading)
PROMOTE_TUNER=1
CI_BACKTEST_GREEN=1
AUTO_DISABLE_ON_ROLLBACK=true

# Auto-learning features (enabled by default for production)
ENHANCED_LEARNING_ENABLED=1
ADAPTIVE_INTELLIGENCE_ENABLED=1
CANARY_WATCHDOG_ENABLED=1
MODEL_REGISTRY_ENABLED=1

# ===================================
# RL RUNTIME MODE (PRODUCTION SAFETY)
# ===================================
# Controls whether reinforcement learning training is allowed
# InferenceOnly = Production default, no training (safe)
# CollectOnly = Collect experiences but don't train (data gathering)
# Train = Full training allowed (development and CI only)
# CHANGED TO Train MODE: Enables EnhancedBacktestLearningService for continuous learning
# Combined with weekly parameter optimization for multiplicative improvements
RlRuntimeMode=Train